@let events = (events$ | async)!;
<div class="md:mx-20 md:mt-10">
  <div class="m-4">
    <button
        class="cursor-pointer
              inline-flex
              items-center
              justify-center
              rounded-md
              bg-green-600
              hover:bg-green-500
              text-xl font-medium
              text-gray-100
              shadow-sm
              focus:outline-none
              w-full md:w-auto
              p-3 md:px-3 md:py-1
              md:text-sm"
        (click)="addEvent()"
    >{{ 'eventList.addEvent' | translate }}</button>
  </div>

  <!-- Dropdown for year selection -->
  <div class="m-4 flex flex-row">
    <label for="category"
          class="mb:text-sm
          text-lg
          md:text-sm
          flex
          justify-center
          font-medium
          text-gray-700
          mr-4
          p-3 md:p-1
          md:w-auto w-1/3">{{ 'eventList.showYear' | translate }}</label>
    <select
      id="category"
      (change)="onYearChange($event)"
      class="flex
            justify-center
            text-lg
            p-3 md:p-1
            border border-gray-300
            focus:outline-none
            focus:ring-indigo-500
            focus:border-indigo-500
            md:text-sm
            rounded-md
            md:w-auto
            w-2/3
            text-center">
      @for(y of allYears(); track $index) {
        <option value="{{y}}" [selected]="y === year()">{{y}}</option>
      }
    </select>
  </div>
@if (events) {
<div class="overflow-x-auto bg-white rounded-lg shadow max-h-[calc(100vh-350px)] md:max-h-[calc(100vh-300px)]">
  <table class="min-w-full divide-y divide-gray-200 table-fixed">
    <thead class="bg-gray-50 sticky top-0 z-20">
      <tr>
        <th></th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.date' | translate }}</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.pdgaEvent' | translate }}</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.displayName' | translate }}</th>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.points' | translate }}</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
        <th scope="col" class="text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.swisstour' | translate }}</th>
        <th scope="col" class="text-center py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">{{ 'eventList.championship' | translate }}</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Registration Start</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Info Link</th>
        <th scope="col" class="whitespace-nowrap px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Registration Link</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200">
      @for (event of events; track $index) {
      <tr>
        <td class="whitespace-nowrap">
          <span class="ml-3 text-gray-600 cursor-pointer px-1"
            (click)="editEvent(event.id!)"><span class="sr-only">Edit</span>âœï¸
          </span>

          <span class="text-gray-600 cursor-pointer px-1"
            (click)="deleteEvent(event)"><span class="sr-only">Close</span>ğŸ—‘ï¸
          </span>

          <button class="inline-flex items-center md:rounded-md md:bg-green-600 px-3 py-1 text-sm font-sm text-gray-100 md:shadow-sm md:hover:bg-green-500 focus:outline-none"
          (click)="addResults(event.id!)"
          [disabled]="event.hasResults"
          [ngClass]="{'disabled-button': event.hasResults}"
          ><span class="hidden md:flex">{{ 'eventList.addResults' | translate }}</span><span class="md:hidden">â•</span></button>
        </td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ event.startDate | dateRange:event.endDate }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ event.eventId }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ event.displayName }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{Â event.points }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{Â event.swisstourType }}</td>
        @switch (event.isSwisstour) {
          @case (true) {
            <td class="px-6 py-4 whitespace-nowrap text-sm justify-center flex text-gray-500">âœ…</td>
          }
          @case (false) {
            <td class="px-6 py-4 whitespace-nowrap text-sm items-center justify-center text-gray-500"></td>
          }
        }
        @switch (event.isChampionship) {
          @case (true) {
            <td class="px-6 py-4 whitespace-nowrap text-sm justify-center text-gray-500 text-center">âœ…</td>
          }
          @case (false) {
            <td class="px-6 py-4 whitespace-nowrap text-sm items-center justify-center text-gray-500 text-center"></td>
          }
        }
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ event.registrationStart | dateRange:undefined }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{Â event.infoLink }}</td>
        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{Â event.registrationLink }}</td>
      </tr>
      }
    </tbody>
  </table>
</div>
}
</div>
